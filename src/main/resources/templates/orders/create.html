<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
    <title>Create Order</title>
</head>
<body>
<div layout:fragment="content">
    <div class="py-5 text-center">
        <h2>Create Order</h2>
    </div>

    <div class="row g-5 justify-content-center">
        <div class="col-md-7 col-lg-8">
            <form class="needs-validation" th:action="@{/orders/create}" th:object="${orderDTO}" method="post">

                <h4 class="mb-3">Customer</h4>
                <div class="col-12 mb-3">
                    <label for="customer" class="form-label">Select Customer</label>
                    <select class="form-select" id="customer" th:field="*{customerId}" required>
                        <option value="">Choose...</option>
                        <option th:each="c : ${customers}" th:value="${c.id}" th:text="${c.firstName + ' ' + c.lastName + ' (' + c.email + ')'}"></option>
                    </select>
                </div>

                <h4 class="mb-3">Shipping Address</h4>
                <div class="row g-3">
                    <div class="col-12">
                        <label for="address" class="form-label">Address</label>
                        <input type="text" class="form-control" id="address" th:field="*{shippingAddressLine1}" required>
                    </div>

                    <div class="col-12">
                        <label for="address2" class="form-label">Address 2 <span class="text-muted">(Optional)</span></label>
                        <input type="text" class="form-control" id="address2" th:field="*{shippingAddressLine2}">
                    </div>

                    <div class="col-md-5">
                        <label for="country" class="form-label">Country</label>
                        <input type="text" class="form-control" id="country" th:field="*{shippingCountry}" required>
                    </div>

                    <div class="col-md-4">
                        <label for="state" class="form-label">State</label>
                        <input type="text" class="form-control" id="state" th:field="*{shippingState}" required>
                    </div>

                     <div class="col-md-4">
                        <label for="city" class="form-label">City</label>
                        <input type="text" class="form-control" id="city" th:field="*{shippingCity}" required>
                    </div>

                    <div class="col-md-3">
                        <label for="zip" class="form-label">Zip</label>
                        <input type="text" class="form-control" id="zip" th:field="*{shippingZipCode}" required>
                    </div>
                </div>

                <h4 class="mb-3 mt-4">Payment</h4>
                <div class="col-12 mb-3">
                     <label for="paymentMethod" class="form-label">Payment Method</label>
                     <select class="form-select" id="paymentMethod" th:field="*{paymentMethod}" required>
                        <option value="">Choose...</option>
                        <option value="CREDIT_CARD">Credit Card</option>
                        <option value="PAYPAL">PayPal</option>
                        <option value="BANK_TRANSFER">Bank Transfer</option>
                     </select>
                </div>

                <h4 class="mb-3 mt-4">Order Items</h4>
                <!-- For simplicity in this demo, we allow adding one item.
                     In a real app, you'd use JavaScript to add multiple rows dynamically. -->
                <div class="row g-3" th:each="item, itemStat : *{items}">
                    <div class="col-md-8">
                        <label class="form-label">Item</label>
                        <select class="form-select" th:field="*{items[__${itemStat.index}__].itemId}" required>
                            <option value="">Choose...</option>
                            <option th:each="inv : ${inventoryItems}" th:value="${inv.item.id}"
                                    th:text="${inv.item.name + ' - $' + inv.item.price + ' (Available: ' + inv.quantityAvailable + ')'}"></option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Quantity</label>
                        <input type="number" class="form-control" th:field="*{items[__${itemStat.index}__].quantity}" min="1" required>
                    </div>
                </div>

                <hr class="my-4">

                <button class="w-100 btn btn-primary btn-lg" type="submit">Place Order</button>
            </form>
        </div>
    </div>
</div>
</body>
</html>
